!function(){var e=function(){this.initialize(),this.init()};e.prototype=new createjs.Container,e.prototype.init=function(){this.face_mc=new createjs.Container,this.game_mc=new createjs.Container,this.cells_mc=new createjs.Container,this._gameOver,this.arButtons=[],this.arItems=[],this.arBgInvent=[],this.levelObj={},this.curObj,login_obj.location=1;var e=preload.getResult("location1_1");this.bgGame=new createjs.Bitmap(e),this.bgGame.scaleX=scaleGraphics,this.bgGame.scaleY=scaleGraphics,this.addChild(this.bgGame),this.addChild(this.game_mc),this.addChild(this.face_mc),this.face_mc.addChild(this.cells_mc),this.loadLevel(),this.touchHandler=this.touchHandler.bind(this),this.addEventListener("mousedown",this.touchHandler),this.addEventListener("pressmove",this.touchHandler),this.addEventListener("pressup",this.touchHandler)},e.prototype.loadLevel=function(){if(login_obj["1_1_doorOpen"]||(this.door=this.addObj("l1_1_door",103,336),this.game_mc.addChild(this.door),this.arItems.push(this.door)),this.Arrow1_L1=this.addObj("Strelka8",100,400),this.Arrow1_L1.name="Arrow1_L1",this.Arrow1_L1._selected=!1,this.Arrow1_L1.visible=!1,this.game_mc.addChild(this.Arrow1_L1),this.Arrow2=this.addObj("Strelka5",800,510),this.Arrow2.name="Arrow2",this.Arrow2._selected=!1,this.Arrow2.visible=!1,this.game_mc.addChild(this.Arrow2),login_obj.puzzle_0||(this.itemPuzzle=new ItemPuzzle(0,500,200,this),this.face_mc.addChild(this.itemPuzzle)),login_obj["1_1_boxOpen"]){var e=this.addObj("l1_1_boxOpen",941,438);if(this.game_mc.addChild(e),login_obj["1_1_gearTook"]);else{var t=this.addObj("l1_5_gear",930,420);this.game_mc.addChild(t),this.arItems.push(t)}}else this.box=this.addObj("l1_1_boxClose",930,450),this.game_mc.addChild(this.box),this.arItems.push(this.box);if(login_obj["1_1_wellOpen"]){var i=this.addObj("l1_1_well",900,570);i.rotation=7,this.game_mc.addChild(i);var s=this.addObj("l1_3_knob",0,0);s.x=-4*scaleGraphics,s.y=-32*scaleGraphics,s.rotation=190,i.addChild(s),this.Arrow2.visible=!0}else this.well=this.addObj("l1_1_well",805,598),this.game_mc.addChild(this.well),this.arItems.push(this.well);var h=preload.getResult("location1_1_dark");if(this.dark=new createjs.Bitmap(h),this.dark.scaleX=scaleGraphics,this.dark.scaleY=scaleGraphics,this.game_mc.addChild(this.dark),this.torch1=this.addObj("l1_1_torch",340,213),this.torch1.name="torch1",this.game_mc.addChild(this.torch1),this.torch2=this.addObj("l1_1_torch",790,205,-1),this.torch2.name="torch2",this.game_mc.addChild(this.torch2),this.torch1Fire=new ItemAnima("animFire"),this.torch1Fire.scaleX=scaleGraphics,this.torch1Fire.scaleY=scaleGraphics,this.torch1Fire.x=325*scaleGraphics,this.torch1Fire.y=170*scaleGraphics,this.torch1Fire.sprite.gotoAndPlay("one"),this.game_mc.addChild(this.torch1Fire),this.torch2Fire=new ItemAnima("animFire"),this.torch2Fire.scaleX=scaleGraphics,this.torch2Fire.scaleY=scaleGraphics,this.torch2Fire.x=800*scaleGraphics,this.torch2Fire.y=170*scaleGraphics,this.torch2Fire.sprite.gotoAndPlay("one"),this.game_mc.addChild(this.torch2Fire),login_obj.tutor_1||login_obj["1_1_torch1Burn"]||login_obj["1_1_torch2Burn"]);else{this.hint=this.addObj("puzzle_light",340,213,.5,.5),this.face_mc.addChild(this.hint),this.hint.alpha=0,h=preload.getResult("handTutor"),this.hand=new createjs.Bitmap(h),this.hand.x=512*scaleGraphics,this.hand.y=500*scaleGraphics,this.hand.scaleX=scaleGraphics,this.hand.scaleY=scaleGraphics,this.face_mc.addChild(this.hand);var r=this;createjs.Tween.get(this.hand).wait(2e3).to({x:340*scaleGraphics,y:213*scaleGraphics},1e3).call(function(){r.textHero.hideText(),r.hero.hideText()}),createjs.Tween.get(this.hint).wait(3e3).to({alpha:1},200).wait(1e3).to({alpha:0},200)}login_obj["1_1_keyTook"]?this.dark.visible=!1:(this.key=this.addObj("l1_1_key",689,60),this.game_mc.addChild(this.key),this.arItems.push(this.key),login_obj["1_1_torch1Burn"]&&login_obj["1_1_torch2Burn"]?this.dark.visible=!1:(this.key.visible=!1,this.torch1Fire.visible=!1,this.torch2Fire.visible=!1,this.arItems.push(this.torch1),this.arItems.push(this.torch2))),this.arItems.push(this.Arrow1_L1),this.arButtons.push(this.Arrow1_L1),this.arItems.push(this.Arrow2),this.arButtons.push(this.Arrow2),this.hero=new ItemHero,this.hero._parent=this,this.hero.scaleY=scaleGraphics,this.game_mc.addChild(this.hero),2==login_obj.prevLoc?(this.hero.scaleX=1*scaleGraphics,this.hero.x=200*scaleGraphics,this.hero.y=380*scaleGraphics):5==login_obj.prevLoc?(this.hero.scaleX=-1*scaleGraphics,this.hero.x=800*scaleGraphics,this.hero.y=400*scaleGraphics):(this.hero.scaleX=-1*scaleGraphics,this.hero.x=500*scaleGraphics,this.hero.y=380*scaleGraphics),this.textHero=new ItemText,this.textHero._parent=this,this.textHero.scaleX=scaleGraphics,this.textHero.scaleY=scaleGraphics,this.textHero.y=this.hero.y-100*scaleGraphics,this.hero.x<300*scaleGraphics?(this.textHero.oblachko.scaleX=-1,this.textHero.x=this.hero.x+200*scaleGraphics):this.textHero.x=this.hero.x-200*scaleGraphics,this.game_mc.addChild(this.textHero),login_obj["1_1_doorOpen"]?this.Arrow1_L1.visible=!0:(this.textHero.showText("emergence_1_1"),this.hero.showText()),this.createCells(),this.loadInvent()},e.prototype.createCells=function(){var e,t=0;for(t=0;8>t;t++){var e=this.addObj("Cell",944-120*t,688);e.alpha=0,e.empty=!0,this.cells_mc.addChild(e),this.arBgInvent.push(e)}},e.prototype.addObj=function(e,t,i,s,h){s||(s=1),h||(h=1);var r=new createjs.Container,a=preload.getResult(e),o=new createjs.Bitmap(a);return o.x=-(o.image.width/2),o.y=-(o.image.height/2),r.addChild(o),r.scaleX=scaleGraphics*s,r.scaleY=scaleGraphics*h,r.x=t*scaleGraphics,r.y=i*scaleGraphics,r.w=o.image.width*scaleGraphics,r.h=o.image.height*scaleGraphics,r.name=e,r.w<50&&(r.w=50),r.h<50&&(r.h=50),r},e.prototype.pushObj=function(e){if(e){var t,i=0;for(i=0;i<this.arBgInvent.length&&(t=this.arBgInvent[i],!t.empty);i++);var s=this;t&&(createjs.Tween.get(t).to({alpha:1},200),createjs.Tween.get(e).to({x:t.x,y:t.y},300).call(function(){"l1_1_key"==e.name?(login_obj["1_1_keyTook"]=!0,reportFound(e.name,"Gold key")):"l1_5_gear"==e.name&&(login_obj["1_1_gearTook"]=!0,reportFound(e.name,"Gear-2")),invent_obj.push(e),s.removeFromArray(s.arItems,e.name),s.face_mc.addChild(e),s.refreshInvent()}))}},e.prototype.clickObj=function(e){var t=e.name;if("l1_1_key"==t)this.pushObj(this.key),this.hand&&createjs.Tween.get(this.hand).wait(1e3).to({x:950*scaleGraphics,y:700*scaleGraphics},1e3).wait(1500).to({x:101*scaleGraphics,y:334*scaleGraphics},2e3);else if("l1_5_gear"==t)this.pushObj(e);else if("l1_1_door"==t)this.curObj?login_obj["1_1_keyTook"]&&"i_l1_1_key"==this.curObj.name&&(reportUsed("l1_1_key","Gold key"),this.hand&&(this.hand.visible=!1,login_obj.tutor_1=!0),createjs.Tween.get(this.door).to({alpha:0},300),this.removeFromArray(this.arItems,t),this.removeFromArray(invent_obj,"i_l1_1_key"),this.face_mc.removeChild(this.curObj),login_obj["1_1_doorOpen"]=!0,this.Arrow1_L1.visible=!0,this.refreshInvent()):(this.textHero.showText("location_1_1_door"),this.hero.showText());else if("l1_1_well"==t)this.curObj?"i_l1_3_knob"==this.curObj.name&&(reportUsed("l1_3_knob","Knob"),this.removeFromArray(this.arItems,t),this.removeFromArray(invent_obj,"i_l1_3_knob"),this.face_mc.removeChild(this.curObj),this.curObj=this.addObj("l1_3_knob",0,0),this.curObj.x=-4*scaleGraphics,this.curObj.y=-32*scaleGraphics,this.curObj.rotation=190,e.addChild(this.curObj),login_obj["1_1_wellOpen"]=!0,createjs.Tween.get(e).to({x:900*scaleGraphics,y:570*scaleGraphics,rotation:7},1e3),this.Arrow2.visible=!0,this.refreshInvent()):(this.textHero.showText("location_1_1_well"),this.hero.showText());else if("l1_1_boxClose"==t){if(this.curObj&&"i_l1_8_key"==this.curObj.name){reportUsed("l1_8_key","Red key"),this.removeFromArray(this.arItems,t),this.removeFromArray(invent_obj,"i_l1_8_key"),this.face_mc.removeChild(this.curObj),login_obj["1_1_boxOpen"]=!0,this.box.visible=!1;var i=this.addObj("l1_1_boxOpen",941,438);if(this.game_mc.addChild(i),login_obj["1_1_gearTook"]);else{var s=this.addObj("l1_5_gear",930,420);this.game_mc.addChild(s),this.arItems.push(s)}this.refreshInvent()}}else if("torch1"==t)login_obj["1_1_torch1Burn"]=!0,this.torch1Fire.visible=!0,this.removeFromArray(this.arItems,t),this.hand&&(login_obj["1_1_torch1Burn"]&&login_obj["1_1_torch2Burn"]?(createjs.Tween.get(this.hand).to({x:689*scaleGraphics,y:60*scaleGraphics},1e3),this.hint.x=689*scaleGraphics,this.hint.y=60*scaleGraphics,createjs.Tween.get(this.hint).wait(1e3).to({alpha:1},200).wait(1e3).to({alpha:0},200)):(createjs.Tween.get(this.hand).to({x:790*scaleGraphics,y:205*scaleGraphics},1e3),this.hint.x=790*scaleGraphics,this.hint.y=205*scaleGraphics,createjs.Tween.get(this.hint).wait(1e3).to({alpha:1},200).wait(1e3).to({alpha:0},200)));else if("torch2"==t)login_obj["1_1_torch2Burn"]=!0,this.torch2Fire.visible=!0,this.removeFromArray(this.arItems,t),this.hand&&(login_obj["1_1_torch1Burn"]&&login_obj["1_1_torch2Burn"]?(createjs.Tween.get(this.hand).to({x:689*scaleGraphics,y:60*scaleGraphics},1e3),this.hint.x=689*scaleGraphics,this.hint.y=60*scaleGraphics,createjs.Tween.get(this.hint).wait(1e3).to({alpha:1},200).wait(1e3).to({alpha:0},200)):(createjs.Tween.get(this.hand).to({x:340*scaleGraphics,y:213*scaleGraphics},1e3),this.hint.x=340*scaleGraphics,this.hint.y=213*scaleGraphics,createjs.Tween.get(this.hint).wait(1e3).to({alpha:1},200).wait(1e3).to({alpha:0},200)));else{if("Arrow1_L1"==t){this._gameOver=!0,e.visible=!1;var h=this;return void this.hero.initMove(this.Arrow1_L1,function(){h.removeAllListener(),showGame(2),saveData()})}if("Arrow2"==t){this._gameOver=!0,e.visible=!1;var h=this;return void this.hero.initMove(this.Arrow2,function(){h.removeAllListener(),showGame(5),saveData()})}}login_obj["1_1_torch1Burn"]&&login_obj["1_1_torch2Burn"]&&1!=login_obj["1_1_keyTook"]&&(createjs.Tween.get(this.dark).to({alpha:0},300),this.key.visible=!0),this.curObj&&this.refreshInvent()},e.prototype.loadInvent=function(){invent_obj=[];for(var e=0;e<login_obj.arInvent.length;e++){var t=login_obj.arInvent[e];if(t){var i=this.addObj(t,0,0);invent_obj.push(i)}}this.refreshInvent()},e.prototype.refreshInvent=function(){var e,t,i=0;for(i=0;i<this.arBgInvent.length;i++){if(t=this.arBgInvent[i],t.empty=!0,invent_obj&&(e=invent_obj[i])){t.empty=!1;var s=e.name,h=s.indexOf("i_");-1==h&&(this.face_mc.removeChild(e),e=this.addObj("i_"+s,0,0),invent_obj[i]=e),e.x=t.x,e.y=t.y,this.face_mc.addChild(e)}t.empty&&1==t.alpha&&createjs.Tween.get(t).to({alpha:0},200),0==t.empty&&0==t.alpha&&createjs.Tween.get(t).to({alpha:1},200)}saveData()},e.prototype.removeFromArray=function(e,t,i){var s,h=0;for(h=0;h<e.length;h++)if(s=e[h],s.name==t){i&&this.face_mc.removeChild(s),e.splice(h,1);break}},e.prototype.turnHandler=function(e){return this._gameOver?void e.remove():void 0},e.prototype.checkInvent=function(e){for(var t=e.stageX,i=e.stageY,s=null,h=0;h<invent_obj.length;h++){var r=invent_obj[h];if(hit_test_rec(r,r.w,r.h,t,i)){s=r;break}}return s},e.prototype.checkButtons=function(e){for(var t=e.stageX,i=e.stageY,s=0;s<this.arButtons.length;s++){var h=this.arButtons[s];hit_test_rec(h,h.w,h.h,t,i)?h.visible&&0==h._selected&&(h._selected=!0,h.scaleX=1.2*scaleGraphics,h.scaleY=1.2*scaleGraphics):h._selected&&(h.scaleX=scaleGraphics,h.scaleY=scaleGraphics,h._selected=!1)}},e.prototype.touchHandler=function(e){if(this._gameOver)return void e.remove();var t,i,s=e.type,h=e.stageX,r=e.stageY,a=0;if("mousedown"==s)this.curObj=this.checkInvent(e),null==this.curObj&&this.checkButtons(e);else if("pressmove"==s)this.checkButtons(e),this.curObj?(this.curObj.x=h,this.curObj.y=r):this.checkButtons(e);else if("pressup"==s){for(i=getDD(this.hero.x,this.hero.y,h,r),this.Hand&&1!=login_obj.tutor_1&&(login_obj.tutor_1=!0,createjs.Tween.get(this.Hand).to({x:480*scaleGraphics,y:320*scaleGraphics},1e3)),i<hitHero*scaleGraphics?this.hero.say?(this.textHero.hideText(),this.hero.hideText()):(this.textHero.showText(),this.hero.showText()):(this.hero.hideText(),this.textHero.hideText(),this.stars&&this.stars.removeAll()),a=0;a<this.arItems.length;a++)if(t=this.arItems[a],hit_test_rec(t,t.w,t.h,h,r)&&t.visible)return void this.clickObj(t);this.curObj&&this.refreshInvent()}},e.prototype.removeAllListener=function(){this.hero&&this.hero.removeAllListener(),this.itemPuzzle&&this.itemPuzzle.removeAllListener(),this._resultGame=!0,this.removeEventListener("mousedown",this.touchHandler),this.removeEventListener("pressmove",this.touchHandler),this.removeEventListener("pressup",this.touchHandler)},window.ScrLocation1=e}();