!function(){var t=function(){this.initialize(),this.init()};t.prototype=new createjs.Container,t.prototype.init=function(){this.face_mc=new createjs.Container,this.game_mc=new createjs.Container,this.decor_mc=new createjs.Container,this.cells_mc=new createjs.Container,this.CONST_BLOCK_W=139*scaleGraphics,this.CONST_TIME=60,this._gameOver,this.arButtons=[],this.arItems=[],this.arBgInvent=[],this.levelObj={},this.curObj,this.startTime=getTimer(),this.arFloor=[],this.arTop=[],this.arDecor=[],this.arLoza=[],this.arHeart=[],this.barrier=!1,this.timeHit=0,this.vAlpha=1,login_obj.location=14,com.funtomic.GameOps.reportEvent("minigame_started",{story_id:lvlNumber,location_id:locNumber,minigame_id:3,minigame_name:"Runner"});var t=preload.getResult("location2_6");this.bg=new createjs.Container,this.bgGame=new createjs.Bitmap(t),this.bgGame.scaleX=scaleGraphics,this.bgGame.scaleY=scaleGraphics,this.bg.addChild(this.bgGame),this.bgGame2=new createjs.Bitmap(t),this.bgGame2.scaleX=scaleGraphics,this.bgGame2.scaleY=scaleGraphics,this.bgGame2.x=_W-2*scaleGraphics,this.bg.addChild(this.bgGame2),this.bg.width=2*_W,this.addChild(this.bg),this.addChild(this.game_mc),this.addChild(this.face_mc),this.addChild(this.decor_mc),this.face_mc.addChild(this.cells_mc),this.loadLevel(),this.touchHandler=this.touchHandler.bind(this),this.addEventListener("mousedown",this.touchHandler),this.addEventListener("pressmove",this.touchHandler),this.addEventListener("pressup",this.touchHandler),createjs.Ticker.on("tick",this.turnHandler,this),createjs.Ticker.setInterval(25),createjs.Ticker.setFPS(40)},t.prototype.loadLevel=function(){this.trap=this.addObj("trap",50,350),this.vTrap=1,this.face_mc.addChild(this.trap),this.btnUp=this.addObj("btnUp",100,400),this.btnUp._selected=!1,this.face_mc.addChild(this.btnUp),this.arButtons.push(this.btnUp),this.btnDown=this.addObj("btnDown",100,600),this.btnDown._selected=!1,this.face_mc.addChild(this.btnDown),this.arButtons.push(this.btnDown),this.wayRun=this.addObj("wayRun",_WO/2,50),this.addChild(this.wayRun),this.arrowRed=this.addObj("arrowRed",0,0),this.arrowRed.x=-this.wayRun.w/2,this.wayRun.addChild(this.arrowRed),this.timeWay=0,this.wRun=this.wayRun.w/scaleGraphics;for(var t=null,e=0;10>e;e++){t=new ItemAnima("block"),t.scaleX=scaleGraphics,t.scaleY=scaleGraphics,t.x=this.CONST_BLOCK_W*e,t.y=650*scaleGraphics,t.sprite.gotoAndStop(0),t.barrier=!1,t.type="floor",t.id=e+1,this.game_mc.addChild(t),this.arFloor.push(t);var i=Math.ceil(3*Math.random());t.decor=this.addObj("grass"+String(i),0,0),t.decor.y=-195,t.addChild(t.decor),Math.random()>.4&&(t.decor.visible=!1)}for(var e=0;10>e;e++){if(t=new ItemAnima("block"),t.scaleX=scaleGraphics,t.scaleY=scaleGraphics,t.x=this.CONST_BLOCK_W*e,t.y=(-200+50*Math.floor(4*Math.random()))*scaleGraphics,t.rotation=180,t.sprite.gotoAndStop(0),t.barrier=!1,t.type="top",t.id=e+1,this.game_mc.addChild(t),this.arTop.push(t),Math.random()>.4){var i=Math.ceil(2*Math.random());t.decor=this.addObj("loza"+String(i),0,0),t.decor.y=-205}else{var i=Math.ceil(3*Math.random());t.decor=this.addObj("grass"+String(i),0,0),t.decor.y=-195}t.addChild(t.decor),Math.random()>.4&&(t.decor.visible=!1)}for(var e=0;3>e;e++){var r=this.addObj("heartEmpty",67*e+40,50);this.addChild(r);var a=this.addObj("heartFull",67*e+40,50);this.addChild(a),this.arHeart.push(a)}this.hero=new ItemHero,this.hero._parent=this,this.hero.scaleY=scaleGraphics,this.face_mc.addChild(this.hero),this.hero.scaleX=1*scaleGraphics,this.hero.x=300*scaleGraphics,this.hero.y=415*scaleGraphics,this.hero.setAct("heroRun"),this.createCells(),this.loadInvent()},t.prototype.createCells=function(){var t,e=0;for(e=0;8>e;e++){var t=this.addObj("Cell",944-120*e,688);t.alpha=0,t.empty=!0,this.cells_mc.addChild(t),this.arBgInvent.push(t)}},t.prototype.addObj=function(t,e,i,r,a){r||(r=1),a||(a=1);var s=new createjs.Container,h=preload.getResult(t),o=new createjs.Bitmap(h);return o.x=-(o.image.width/2),o.y=-(o.image.height/2),s.addChild(o),s.scaleX=scaleGraphics*r,s.scaleY=scaleGraphics*a,s.x=e*scaleGraphics,s.y=i*scaleGraphics,s.w=o.image.width*s.scaleX,s.h=o.image.height*s.scaleY,s.name=t,s.w<50&&(s.w=50),s.h<50&&(s.h=50),s},t.prototype.loadInvent=function(){invent_obj2=[];for(var t=0;t<login_obj.arInvent2.length;t++){var e=login_obj.arInvent2[t];if(e){var i=this.addObj(e,0,0);invent_obj2.push(i)}}this.refreshInvent()},t.prototype.refreshInvent=function(){var t,e,i=0;for(i=0;i<this.arBgInvent.length;i++){if(e=this.arBgInvent[i],e.empty=!0,invent_obj2&&(t=invent_obj2[i])){e.empty=!1;var r=t.name,a=r.indexOf("i_");-1==a&&(this.face_mc.removeChild(t),t=this.addObj("i_"+r,0,0),invent_obj2[i]=t),t.x=e.x,t.y=e.y,this.face_mc.addChild(t)}e.empty&&1==e.alpha&&createjs.Tween.get(e).to({alpha:0},200),0==e.empty&&0==e.alpha&&createjs.Tween.get(e).to({alpha:1},200)}saveData()},t.prototype.removeFromArray=function(t,e,i){var r,a=0;for(a=0;a<t.length;a++)if(r=t[a],r.name==e){i&&this.face_mc.removeChild(r),t.splice(a,1);break}},t.prototype.resetTimer=function(){this.startTime=getTimer()},t.prototype.turnHandler=function(t){if(!options_pause){if(this._gameOver)return void t.remove();var e=getTimer()-this.startTime,i=.4*scaleGraphics,r=null;this.bg.x-=.1*e*scaleGraphics,this.bg.x<-_W&&(this.bg.x=0),this.trap.x>65*scaleGraphics?this.vTrap=-1:this.trap.x<35*scaleGraphics&&(this.vTrap=1),this.trap.x+=.03*e*scaleGraphics*this.vTrap,this.timeWay+=e/1e3;var a=this.timeWay/this.CONST_TIME;this.arrowRed.x<this.wRun/2-10?this.arrowRed.x=a*this.wRun-this.wRun/2:(login_obj.l2_5_stellaFire=!0,login_obj.l2_5_stellaFire&&login_obj.l2_8_stellaFire&&login_obj.l2_10_stellaFire&&this.removeFromArray(invent_obj2,"i_l2_3_lamp",!0),this.removeAllListener(),com.funtomic.GameOps.reportEvent("minigame_ended",{story_id:lvlNumber,location_id:locNumber,minigame_id:3,minigame_name:"Runner"}),showGame(15));for(var s=null,h=null,o=0;o<this.arFloor.length;o++){if(r=this.arFloor[o],r.x-=i*e,0==o&&r.x<-(i*e+1.5*r.width)){var n=this.arFloor[this.arFloor.length-1],l=this.arFloor[this.arFloor.length-2];if(n.barrier||l.barrier&&this.arrowRed.x<this.wRun/5)r.sprite.gotoAndStop(0),r.barrier=!1,this.barrier=!1;else{var c=this.arTop[this.arTop.length-1],d=this.arTop[this.arTop.length-2];c.barrier||d.barrier&&this.arrowRed.x<this.wRun/5?(r.sprite.gotoAndStop(0),r.barrier=!1,this.barrier=!1):this.barrier=Math.random()>.65}this.barrier?Math.random()>.5&&(r.sprite.gotoAndStop(1),r.barrier=!0,this.barrier=!1):(r.sprite.gotoAndStop(0),r.barrier=!1),r.x=n.x+this.CONST_BLOCK_W,r.barrier?(r.y=650*scaleGraphics,r.decor.visible=!1):(r.y=650*scaleGraphics,r.decor.visible=Math.random()>.6?!0:!1),this.arFloor.splice(o,1),this.arFloor.push(r)}s?r.x>_W&&(s=r):s=r}for(var o=0;o<this.arTop.length;o++){if(r=this.arTop[o],r.x-=i*e,0==o&&r.x<-(i*e+1.5*r.width)){var n=this.arTop[this.arTop.length-1],p=this.arFloor[this.arFloor.length-1];this.barrier&&!p.barrier?(r.sprite.gotoAndStop(1),r.barrier=!0,this.barrier=!1):(r.sprite.gotoAndStop(0),r.barrier=!1),r.x=n.x+this.CONST_BLOCK_W,r.barrier?(r.y=180*scaleGraphics,r.decor.visible=!1):(r.y=(-200+50*Math.floor(4*Math.random()))*scaleGraphics,r.decor.visible=Math.random()>.6?!0:!1),this.arTop.splice(o,1),this.arTop.push(r)}h?r.x>_W&&(h=r):h=r}for(var m=this.arFloor.concat(this.arTop),v=this.hero.x,b=this.CONST_BLOCK_W,_=!1,o=0;o<m.length;o++)r=m[o],r.barrier&&v>r.x-b/2&&v<r.x+b/2&&("floor"==r.type&&"heroJump"!=this.hero._act?_=!0:"top"==r.type&&"heroRoll"!=this.hero._act&&(_=!0));if(this.timeHit>0)if(this.timeHit-=e,this.timeHit>50){this.hero.alpha>.9?this.vAlpha=-1:this.hero.alpha<.1&&(this.vAlpha=1);var g=this.hero.alpha+.1*this.vAlpha;this.hero.alpha=Math.min(g,1),this.hero.alpha=Math.max(g,0)}else this.hero.alpha=1;if(_&&this.timeHit<1)if(this.arHeart.length>1){var o=this.arHeart.length-1,u=this.arHeart[o];this.removeChild(u),this.arHeart.splice(o,1),this.timeHit=2e3}else this.removeAllListener(),showGame(13);this.startTime=getTimer()}},t.prototype.checkButtons=function(t){for(var e=t.stageX,i=t.stageY,r=0;r<this.arButtons.length;r++){var a=this.arButtons[r];hit_test_rec(a,a.w,a.h,e,i)?a.visible&&0==a._selected&&(a._selected=!0,a.scaleX=1.2*scaleGraphics,a.scaleY=1.2*scaleGraphics):a._selected&&(a.scaleX=scaleGraphics,a.scaleY=scaleGraphics,a._selected=!1)}},t.prototype.touchHandler=function(t){if(this._gameOver)return void t.remove();var e,i=t.type,r=(t.stageX,t.stageY,0);if("mousedown"==i){for(this.checkButtons(t),r=0;r<this.arButtons.length;r++)if(e=this.arButtons[r],e._selected)return void("btnUp"==e.name?this.hero.setAct("heroJump"):"btnDown"==e.name&&this.hero.setAct("heroRoll"))}else if("pressmove"==i)this.checkButtons(t);else if("pressup"==i)for(r=0;r<this.arButtons.length;r++)e=this.arButtons[r],e._selected&&(e.scaleX=scaleGraphics,e.scaleY=scaleGraphics,e._selected=!1)},t.prototype.removeAllListener=function(){this.hero&&this.hero.removeAllListener(),this._resultGame=!0,this._gameOver=!0,this.removeEventListener("mousedown",this.touchHandler),this.removeEventListener("pressmove",this.touchHandler),this.removeEventListener("pressup",this.touchHandler)},window.ScrLocation14=t}();