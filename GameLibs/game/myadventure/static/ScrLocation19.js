!function(){var e=function(){this.initialize(),this.init()};e.prototype=new createjs.Container,e.prototype.init=function(){this.face_mc=new createjs.Container,this.game_mc=new createjs.Container,this.cells_mc=new createjs.Container,this._gameOver,this.arButtons=[],this.arItems=[],this.arBgInvent=[],this.levelObj={},this.curObj,login_obj.location=19;var e=preload.getResult("location2_11");this.bgGame=new createjs.Bitmap(e),this.bgGame.scaleX=scaleGraphics,this.bgGame.scaleY=scaleGraphics,this.addChild(this.bgGame),this.addChild(this.game_mc),this.addChild(this.face_mc),this.face_mc.addChild(this.cells_mc),this.loadLevel(),this.touchHandler=this.touchHandler.bind(this),this.addEventListener("mousedown",this.touchHandler),this.addEventListener("pressmove",this.touchHandler),this.addEventListener("pressup",this.touchHandler)},e.prototype.loadLevel=function(){this.Arrow1=this.addObj("Strelka1",520,240),this.Arrow1.name="Arrow1",this.Arrow1._selected=!1,this.game_mc.addChild(this.Arrow1),this.Arrow2=this.addObj("Strelka3",850,550),this.Arrow2.name="Arrow2",this.Arrow2._selected=!1,this.game_mc.addChild(this.Arrow2),login_obj.l2_19_doorOpen||(this.Arrow1.visible=!1,this.door=this.addObj("l2_10_door",515,20),this.game_mc.addChild(this.door));var e=this.addObj("l2_11_border",515,89);this.game_mc.addChild(e);var t=this.addObj("l2_11_block2",70,405);t.name="blockWater",this.game_mc.addChild(t);var i=this.addObj("l2_11_block1",185,368);i.name="blockEarth",this.game_mc.addChild(i);var s=this.addObj("l2_11_block1",290,331);s.name="blockFire",this.game_mc.addChild(s);var r=this.addObj("l2_11_block1",930,335);if(r.name="blockAir",this.game_mc.addChild(r),t.h=2*t.h,i.h=2*i.h,s.h=2*s.h,r.h=2*r.h,login_obj.l2_19_doorOpen){var h=this.addObj("l2_3_water",75,375);this.game_mc.addChild(h);var a=this.addObj("l2_10_eatrh",190,338);this.game_mc.addChild(a);var o=this.addObj("l2_1_fire",295,301);this.game_mc.addChild(o);var l=this.addObj("l2_9_air",935,305);this.game_mc.addChild(l)}else{this.arItems.push(t),this.arItems.push(i),this.arItems.push(s),this.arItems.push(r);var _=login_obj.set_l2_3_water,n=login_obj.set_l2_10_eatrh,c=login_obj.set_l2_1_fire,d=login_obj.set_l2_9_air,m=[];if(m.blockWater=t,m.blockEarth=i,m.blockFire=s,m.blockAir=r,_){var p=this.addObj("l2_3_water",_.x,_.y);p.mc=m[_.type],this.removeFromArray(this.arItems,_.type),this.game_mc.addChild(p),login_obj.l2_19_doorOpen||this.arItems.push(p)}if(n){var p=this.addObj("l2_10_eatrh",n.x,n.y);p.mc=m[n.type],this.removeFromArray(this.arItems,n.type),this.game_mc.addChild(p),login_obj.l2_19_doorOpen||this.arItems.push(p)}if(c){var p=this.addObj("l2_1_fire",c.x,c.y);p.mc=m[c.type],this.removeFromArray(this.arItems,c.type),this.game_mc.addChild(p),login_obj.l2_19_doorOpen||this.arItems.push(p)}if(d){var p=this.addObj("l2_9_air",d.x,d.y);p.mc=m[d.type],this.removeFromArray(this.arItems,d.type),this.game_mc.addChild(p),login_obj.l2_19_doorOpen||this.arItems.push(p)}}if(login_obj.l2_19_keyTook);else{var v=this.addObj("l1_1_key",50,200);v.scaleX=1.5*scaleGraphics,v.scaleY=1.5*scaleGraphics,v.rotation=110,this.game_mc.addChild(v),this.arItems.push(v)}this.arItems.push(this.Arrow1),this.arButtons.push(this.Arrow1),this.arItems.push(this.Arrow2),this.arButtons.push(this.Arrow2),this.hero=new ItemHero,this.hero._parent=this,this.hero.scaleY=scaleGraphics,this.game_mc.addChild(this.hero),20==login_obj.prevLoc?(this.hero.scaleX=1*scaleGraphics,this.hero.x=500*scaleGraphics,this.hero.y=350*scaleGraphics):(this.hero.scaleX=-1*scaleGraphics,this.hero.x=650*scaleGraphics,this.hero.y=500*scaleGraphics),this.textHero=new ItemText,this.textHero._parent=this,this.textHero.scaleX=scaleGraphics,this.textHero.scaleY=scaleGraphics,this.textHero.y=this.hero.y-100*scaleGraphics,this.hero.x<300*scaleGraphics?(this.textHero.oblachko.scaleX=-1,this.textHero.x=this.hero.x+200*scaleGraphics):this.textHero.x=this.hero.x-200*scaleGraphics,this.game_mc.addChild(this.textHero),login_obj.l2_19_doorOpen||(this.hero.showText(),this.textHero.showText("emergence_2_11")),this.createCells(),this.loadInvent()},e.prototype.createCells=function(){var e,t=0;for(t=0;8>t;t++){var e=this.addObj("Cell",944-120*t,688);e.alpha=0,e.empty=!0,this.cells_mc.addChild(e),this.arBgInvent.push(e)}},e.prototype.addObj=function(e,t,i,s,r){s||(s=1),r||(r=1);var h=new createjs.Container,a=preload.getResult(e),o=new createjs.Bitmap(a);return o.x=-(o.image.width/2),o.y=-(o.image.height/2),h.addChild(o),h.scaleX=scaleGraphics*s,h.scaleY=scaleGraphics*r,h.x=t*scaleGraphics,h.y=i*scaleGraphics,h.w=o.image.width*h.scaleX,h.h=o.image.height*h.scaleY,h.name=e,h.w<50&&(h.w=50),h.h<50&&(h.h=50),h},e.prototype.pushObj=function(e){if(e){var t,i=0;for(i=0;i<this.arBgInvent.length&&(t=this.arBgInvent[i],!t.empty);i++);var s=this;t&&(createjs.Tween.get(t).to({alpha:1},200),createjs.Tween.get(e).to({x:t.x,y:t.y},300).call(function(){"l1_1_key"==e.name&&(login_obj.l2_19_keyTook=!0,reportFound(e.name,"Gold key")),invent_obj2.push(e),s.removeFromArray(s.arItems,e.name),s.face_mc.addChild(e),s.refreshInvent()}))}},e.prototype.clickObj=function(e){var t=e.name,i=this;if(this.curObj){var s=this.curObj.name;if(!("blockWater"!=t&&"blockEarth"!=t&&"blockFire"!=t&&"blockAir"!=t||"i_l2_3_water"!=s&&"i_l2_10_eatrh"!=s&&"i_l2_1_fire"!=s&&"i_l2_9_air"!=s)){var r=s.slice(2,s.length),h=this.addObj(r,0,0);h.x=e.x+5*scaleGraphics,h.y=e.y-30*scaleGraphics,this.game_mc.addChild(h),this.removeFromArray(this.arItems,t),this.removeFromArray(invent_obj2,this.curObj.name,!0),this.refreshInvent(),this.arItems.push(h),h.mc=e,login_obj["set_"+r]={x:h.x/scaleGraphics,y:h.y/scaleGraphics,type:t}}"blockWater"==t&&"i_l2_3_water"==s?login_obj.l2_19_setWater=!0:"blockEarth"==t&&"i_l2_10_eatrh"==s?login_obj.l2_19_setEarth=!0:"blockFire"==t&&"i_l2_1_fire"==s?login_obj.l2_19_setFire=!0:"blockAir"==t&&"i_l2_9_air"==s&&(login_obj.l2_19_setAir=!0),login_obj.l2_19_setWater&&login_obj.l2_19_setEarth&&login_obj.l2_19_setFire&&login_obj.l2_19_setAir?(this.removeFromArray(this.arItems,"l2_1_fire"),this.removeFromArray(this.arItems,"l2_3_water"),this.removeFromArray(this.arItems,"l2_10_eatrh"),this.removeFromArray(this.arItems,"l2_9_air"),login_obj.l2_19_doorOpen=!0,this.Arrow1.visible=!0,createjs.Tween.get(this.door).to({y:-150*scaleGraphics},1500),reportUsed("l2_1_fire","Element fire"),reportUsed("l2_3_water","Element water"),reportUsed("l2_9_air","Element air"),reportUsed("l2_10_eatrh","Element earth"),saveData()):login_obj.set_l2_3_water&&login_obj.set_l2_10_eatrh&&login_obj.set_l2_1_fire&&login_obj.set_l2_9_air&&(this.hero.showText(),this.textHero.showText("location_2_11_check"))}else if("l1_1_key"==t)this.pushObj(e);else if("l2_1_fire"==t||"l2_3_water"==t||"l2_10_eatrh"==t||"l2_9_air"==t)e.mc&&this.arItems.push(e.mc),this.pushObj(e),login_obj["set_"+t]=null,"l2_3_water"==t?login_obj.l2_19_setWater=!1:"l2_10_eatrh"==t?login_obj.l2_19_setEarth=!1:"l2_1_fire"==t?login_obj.l2_19_setFire=!1:"l2_9_air"==t&&(login_obj.l2_19_setAir=!1);else{if("Arrow1"==t)return this._gameOver=!0,e.visible=!1,void this.hero.initMove(e,function(){i.removeAllListener(),showGame(20),saveData()});if("Arrow2"==t)return this._gameOver=!0,e.visible=!1,void this.hero.initMove(e,function(){i.removeAllListener(),showGame(10),saveData()})}this.curObj&&this.refreshInvent()},e.prototype.loadInvent=function(){invent_obj2=[];for(var e=0;e<login_obj.arInvent2.length;e++){var t=login_obj.arInvent2[e];if(t){var i=this.addObj(t,0,0);invent_obj2.push(i)}}this.refreshInvent()},e.prototype.refreshInvent=function(){var e,t,i=0;for(i=0;i<this.arBgInvent.length;i++){if(t=this.arBgInvent[i],t.empty=!0,invent_obj2&&(e=invent_obj2[i])){t.empty=!1;var s=e.name,r=s.indexOf("i_");-1==r&&(this.face_mc.removeChild(e),e=this.addObj("i_"+s,0,0),invent_obj2[i]=e),e.x=t.x,e.y=t.y,this.face_mc.addChild(e)}t.empty&&1==t.alpha&&createjs.Tween.get(t).to({alpha:0},200),0==t.empty&&0==t.alpha&&createjs.Tween.get(t).to({alpha:1},200)}saveData()},e.prototype.removeFromArray=function(e,t,i){var s,r=0;for(r=0;r<e.length;r++)if(s=e[r],s.name==t){i&&this.face_mc.removeChild(s),e.splice(r,1);break}},e.prototype.turnHandler=function(e){return this._gameOver?void e.remove():void 0},e.prototype.checkInvent=function(e){for(var t=e.stageX,i=e.stageY,s=null,r=0;r<invent_obj2.length;r++){var h=invent_obj2[r];if(hit_test_rec(h,h.w,h.h,t,i)){s=h;break}}return s},e.prototype.checkButtons=function(e){for(var t=e.stageX,i=e.stageY,s=0;s<this.arButtons.length;s++){var r=this.arButtons[s];hit_test_rec(r,r.w,r.h,t,i)?r.visible&&0==r._selected&&(r._selected=!0,r.scaleX=1.2*scaleGraphics,r.scaleY=1.2*scaleGraphics):r._selected&&(r.scaleX=scaleGraphics,r.scaleY=scaleGraphics,r._selected=!1)}},e.prototype.touchHandler=function(e){if(this._gameOver)return void e.remove();var t,i,s=e.type,r=e.stageX,h=e.stageY,a=0;if("mousedown"==s)this.curObj=this.checkInvent(e),null==this.curObj&&this.checkButtons(e);else if("pressmove"==s)this.checkButtons(e),this.curObj?(this.curObj.x=r,this.curObj.y=h):this.checkButtons(e);else if("pressup"==s){for(i=getDD(this.hero.x,this.hero.y,r,h),i<hitHero*scaleGraphics?this.hero.say?(this.hero.hideText(),this.textHero.hideText()):(this.hero.showText(),this.textHero.showText()):(this.hero.hideText(),this.textHero.hideText()),a=0;a<this.arItems.length;a++)if(t=this.arItems[a],hit_test_rec(t,t.w,t.h,r,h)&&t.visible)return void this.clickObj(t);this.curObj&&this.refreshInvent()}},e.prototype.removeAllListener=function(){this.hero&&this.hero.removeAllListener(),this._resultGame=!0,this.removeEventListener("mousedown",this.touchHandler),this.removeEventListener("pressmove",this.touchHandler),this.removeEventListener("pressup",this.touchHandler)},window.ScrLocation19=e}();