!function(){var e=function(){this.initialize(),this.init()};e.prototype=new createjs.Container,e.prototype.init=function(){this.face_mc=new createjs.Container,this.game_mc=new createjs.Container,this.cells_mc=new createjs.Container,this._gameOver,this.arButtons=[],this.arItems=[],this.arBgInvent=[],this.levelObj={},this.curObj,this.moveBlock=!1,login_obj.location=18;var e=preload.getResult("location2_10");this.bgGame=new createjs.Bitmap(e),this.bgGame.scaleX=scaleGraphics,this.bgGame.scaleY=scaleGraphics,this.addChild(this.bgGame),this.addChild(this.game_mc),this.addChild(this.face_mc),this.face_mc.addChild(this.cells_mc),this.loadLevel(),this.touchHandler=this.touchHandler.bind(this),this.addEventListener("mousedown",this.touchHandler),this.addEventListener("pressmove",this.touchHandler),this.addEventListener("pressup",this.touchHandler)},e.prototype.loadLevel=function(){this.Arrow1=this.addObj("Strelka1",150,400),this.Arrow1.name="Arrow1",this.Arrow1._selected=!1,this.game_mc.addChild(this.Arrow1);var e=new ItemAnima("animFire");e.scaleX=scaleGraphics,e.scaleY=scaleGraphics,e.x=940*scaleGraphics,e.y=200*scaleGraphics,e.sprite.gotoAndPlay("one"),this.game_mc.addChild(e);var e=new ItemAnima("animFire");e.scaleX=scaleGraphics,e.scaleY=scaleGraphics,e.x=100*scaleGraphics,e.y=190*scaleGraphics,e.sprite.gotoAndPlay("one"),this.game_mc.addChild(e),login_obj.puzzle_10||(this.itemPuzzle=new ItemPuzzle(10,580,660,this),this.face_mc.addChild(this.itemPuzzle));var t=this.addObj("l2_5_stella",800,435);if(this.game_mc.addChild(t),login_obj.l2_10_eatrhTook);else{var s=this.addObj("l2_10_eatrh",550,410);this.game_mc.addChild(s),this.arItems.push(s)}if(login_obj.l2_10_stellaFire){var e=new ItemAnima("animFire");e.scaleX=scaleGraphics,e.scaleY=scaleGraphics,e.x=825*scaleGraphics,e.y=315*scaleGraphics,e.sprite.gotoAndPlay("one"),this.game_mc.addChild(e)}else this.arItems.push(t);if(this.blocks1=this.addBlock("blocks1",470,90),this.game_mc.addChild(this.blocks1),this.blocks2=this.addBlock("blocks2",555,90),this.game_mc.addChild(this.blocks2),this.blocks3=this.addBlock("blocks3",645,90),this.game_mc.addChild(this.blocks3),login_obj.l2_10_openDoor)this.blocks1.blocks.y=-182,this.blocks2.blocks.y=-62,this.blocks3.blocks.y=-102;else{this.arItems.push(this.blocks1),this.arItems.push(this.blocks2),this.arItems.push(this.blocks3),this.door=this.addObj("l2_10_door",555,300),this.game_mc.addChild(this.door);var i=new createjs.Shape;i.x=this.door.x-this.door.w/2,i.y=this.door.y-this.door.h/2,i.graphics.beginFill("#FFFFFF").drawRect(0,0,this.door.w,this.door.h),this.door.mask=i}this.arItems.push(this.Arrow1),this.arButtons.push(this.Arrow1),this.hero=new ItemHero,this.hero._parent=this,this.hero.scaleY=scaleGraphics,this.game_mc.addChild(this.hero),this.hero.scaleX=1*scaleGraphics,this.hero.x=250*scaleGraphics,this.hero.y=500*scaleGraphics,this.textHero=new ItemText,this.textHero._parent=this,this.textHero.scaleX=scaleGraphics,this.textHero.scaleY=scaleGraphics,this.textHero.y=this.hero.y-100*scaleGraphics,this.hero.x<300*scaleGraphics?(this.textHero.oblachko.scaleX=-1,this.textHero.x=this.hero.x+200*scaleGraphics):this.textHero.x=this.hero.x-200*scaleGraphics,this.game_mc.addChild(this.textHero),login_obj.l2_10_openDoor||(this.hero.showText(),this.textHero.showText("emergence_2_10")),this.createCells(),this.loadInvent()},e.prototype.addBlock=function(e,t,s){var i=new createjs.Container,a=preload.getResult("l2_10_blocks");i.blocks=new createjs.Bitmap(a),i.blocks.x=-(i.blocks.image.width/2),i.blocks.y=-62,i.addChild(i.blocks),a=preload.getResult("l2_10_border");var h=new createjs.Bitmap(a);h.x=-(h.image.width/2),h.y=-(h.image.height/2),i.addChild(h),i.scaleX=scaleGraphics,i.scaleY=scaleGraphics,i.x=t*scaleGraphics,i.y=s*scaleGraphics,i.w=h.image.width*i.scaleX,i.h=h.image.height*i.scaleY,i.name=e;var r=new createjs.Shape;return r.x=-21,r.y=-36,r.graphics.beginFill("#FFFFFF").drawRect(0,0,42,72),i.blocks.mask=r,i},e.prototype.createCells=function(){var e,t=0;for(t=0;8>t;t++){var e=this.addObj("Cell",944-120*t,688);e.alpha=0,e.empty=!0,this.cells_mc.addChild(e),this.arBgInvent.push(e)}},e.prototype.addObj=function(e,t,s,i,a){i||(i=1),a||(a=1);var h=new createjs.Container,r=preload.getResult(e),o=new createjs.Bitmap(r);return o.x=-(o.image.width/2),o.y=-(o.image.height/2),h.addChild(o),h.scaleX=scaleGraphics*i,h.scaleY=scaleGraphics*a,h.x=t*scaleGraphics,h.y=s*scaleGraphics,h.w=o.image.width*h.scaleX,h.h=o.image.height*h.scaleY,h.name=e,h.w<50&&(h.w=50),h.h<50&&(h.h=50),h},e.prototype.pushObj=function(e){if(e){var t,s=0;for(s=0;s<this.arBgInvent.length&&(t=this.arBgInvent[s],!t.empty);s++);var i=this;t&&(createjs.Tween.get(t).to({alpha:1},200),createjs.Tween.get(e).to({x:t.x,y:t.y},300).call(function(){"l2_10_eatrh"==e.name&&(login_obj.l2_10_eatrhTook=!0,reportFound(e.name,"Element earth")),invent_obj2.push(e),i.removeFromArray(i.arItems,e.name),i.face_mc.addChild(e),i.refreshInvent()}))}},e.prototype.clickObj=function(e){var t=e.name,s=this;if(this.curObj){if("l2_5_stella"==t&&"i_l2_3_lamp"==this.curObj.name){reportUsed("l2_3_lamp","Lamp");var i=new ItemAnima("animFire");i.scaleX=scaleGraphics,i.scaleY=scaleGraphics,i.x=825*scaleGraphics,i.y=315*scaleGraphics,i.sprite.gotoAndPlay("one"),this.game_mc.addChild(i),this.removeFromArray(this.arItems,t),login_obj.l2_10_stellaFire=!0,login_obj.l2_5_stellaFire&&login_obj.l2_8_stellaFire&&login_obj.l2_10_stellaFire&&this.removeFromArray(invent_obj2,"i_l2_3_lamp",!0),this.refreshInvent()}}else if("blocks1"==t||"blocks2"==t||"blocks3"==t){if(0==this.moveBlock){this.moveBlock=!0;var a=e.blocks;createjs.Tween.get(a).to({y:a.y-40},300).call(function(){s.moveBlock=!1,a.y<=-222&&(a.y=-62),-182==s.blocks1.blocks.y&&-62==s.blocks2.blocks.y&&-102==s.blocks3.blocks.y&&(this.moveBlock=!0,login_obj.l2_10_openDoor=!0,createjs.Tween.get(s.door).to({y:0*scaleGraphics},1e3))})}}else if("l2_10_eatrh"==t&&login_obj.l2_10_openDoor)this.pushObj(e);else if("Arrow1"==t)return this._gameOver=!0,e.visible=!1,void this.hero.initMove(e,function(){s.removeAllListener(),showGame(17),saveData()});this.curObj&&this.refreshInvent()},e.prototype.loadInvent=function(){invent_obj2=[];for(var e=0;e<login_obj.arInvent2.length;e++){var t=login_obj.arInvent2[e];if(t){var s=this.addObj(t,0,0);invent_obj2.push(s)}}this.refreshInvent()},e.prototype.refreshInvent=function(){var e,t,s=0;for(s=0;s<this.arBgInvent.length;s++){if(t=this.arBgInvent[s],t.empty=!0,invent_obj2&&(e=invent_obj2[s])){t.empty=!1;var i=e.name,a=i.indexOf("i_");-1==a&&(this.face_mc.removeChild(e),e=this.addObj("i_"+i,0,0),invent_obj2[s]=e),e.x=t.x,e.y=t.y,this.face_mc.addChild(e)}t.empty&&1==t.alpha&&createjs.Tween.get(t).to({alpha:0},200),0==t.empty&&0==t.alpha&&createjs.Tween.get(t).to({alpha:1},200)}saveData()},e.prototype.removeFromArray=function(e,t,s){var i,a=0;for(a=0;a<e.length;a++)if(i=e[a],i.name==t){s&&this.face_mc.removeChild(i),e.splice(a,1);break}},e.prototype.turnHandler=function(e){return this._gameOver?void e.remove():void 0},e.prototype.checkInvent=function(e){for(var t=e.stageX,s=e.stageY,i=null,a=0;a<invent_obj2.length;a++){var h=invent_obj2[a];if(hit_test_rec(h,h.w,h.h,t,s)){i=h;break}}return i},e.prototype.checkButtons=function(e){for(var t=e.stageX,s=e.stageY,i=0;i<this.arButtons.length;i++){var a=this.arButtons[i];hit_test_rec(a,a.w,a.h,t,s)?a.visible&&0==a._selected&&(a._selected=!0,a.scaleX=1.2*scaleGraphics,a.scaleY=1.2*scaleGraphics):a._selected&&(a.scaleX=scaleGraphics,a.scaleY=scaleGraphics,a._selected=!1)}},e.prototype.touchHandler=function(e){if(this._gameOver)return void e.remove();var t,s,i=e.type,a=e.stageX,h=e.stageY,r=0;if("mousedown"==i)this.curObj=this.checkInvent(e),null==this.curObj&&this.checkButtons(e);else if("pressmove"==i)this.checkButtons(e),this.curObj?(this.curObj.x=a,this.curObj.y=h):this.checkButtons(e);else if("pressup"==i){for(s=getDD(this.hero.x,this.hero.y,a,h),s<hitHero*scaleGraphics?this.hero.say?(this.hero.hideText(),this.textHero.hideText()):(this.hero.showText(),this.textHero.showText()):(this.hero.hideText(),this.textHero.hideText()),r=0;r<this.arItems.length;r++)if(t=this.arItems[r],hit_test_rec(t,t.w,t.h,a,h)&&t.visible)return void this.clickObj(t);this.curObj&&this.refreshInvent()}},e.prototype.removeAllListener=function(){this.hero&&this.hero.removeAllListener(),this._resultGame=!0,this.removeEventListener("mousedown",this.touchHandler),this.removeEventListener("pressmove",this.touchHandler),this.removeEventListener("pressup",this.touchHandler)},window.ScrLocation18=e}();