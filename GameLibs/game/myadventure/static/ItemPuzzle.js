!function(){var e=function(e,t,i,a){this.initialize(),this.init(e,t,i,a)};e.prototype=new createjs.Container,e.prototype.init=function(e,t,i,a){this._remove=!1,this._prnt=a,this._id=e,this._hero=null,login_obj.arPuzzle||(login_obj.arPuzzle=[]);var s=50*scaleGraphics,h=50*scaleGraphics;50>s&&(s=50),50>h&&(h=50),this.dark=new createjs.Shape,this.dark.x=t*scaleGraphics,this.dark.y=i*scaleGraphics,this.dark.graphics.beginFill("#0000000").drawRect(-s/2,-h/2,s,h),this.dark.alpha=.01,this.addChild(this.dark),this.w=s,this.h=h,this.puzzle=this.addObj("puzzle_alpha",t,i),this.addChild(this.puzzle),this.touchHandler=this.touchHandler.bind(this),this.addEventListener("mousedown",this.touchHandler),this.addEventListener("pressmove",this.touchHandler),this.addEventListener("pressup",this.touchHandler)},e.prototype.addObj=function(e,t,i){var a=new createjs.Container,s=preload.getResult(e),h=new createjs.Bitmap(s);return h.x=-(h.image.width/2),h.y=-(h.image.height/2),a.addChild(h),a.scaleX=scaleGraphics,a.scaleY=scaleGraphics,a.x=t*scaleGraphics,a.y=i*scaleGraphics,a.w=h.image.width*scaleGraphics,a.h=h.image.height*scaleGraphics,a.name=e,a},e.prototype.pushPuzzle=function(e){if(e){var t=this,i=this.addObj("puzzle_light",0,0);i.x=_W/2-5*scaleGraphics,i.y=_H/2+5*scaleGraphics,i.alpha=0,this.addChild(i);var a=this.addObj("puzzle_ico",0,0);a.x=50*scaleGraphics,a.y=50*scaleGraphics,a.alpha=0,this.addChild(a);var s=login_obj.arPuzzle.length,h=String(s)+"/18",r=new createjs.Text(h,36*scaleGraphics+"px impact","#ffffff");r.lineWidth=230,r.textAlign="left",r.x=100*scaleGraphics,r.y=35*scaleGraphics+options_txt_offset,this.addChild(r);var l=this.addObj("puzzle_for_anim",0,0);l.x=e.x,l.y=e.y,l.alpha=0,this.addChild(l);var o=50*scaleGraphics,n=50*scaleGraphics;this.removeChild(e),createjs.Tween.get(a).to({alpha:1},300).wait(3e3).to({alpha:0},300).call(function(){t.removeAllListener()}),createjs.Tween.get(r).to({alpha:1},300).wait(3e3).to({alpha:0},300),createjs.Tween.get(i).to({alpha:1},300).to({rotation:360},1500).to({alpha:0},300),createjs.Tween.get(l).to({x:_W/2,y:_H/2,alpha:1},300).wait(1500).to({x:o,y:n},300).call(function(){login_obj.arPuzzle.push(t._id),login_obj["puzzle_"+t._id]=!0,s++,h=String(s)+"/18",r.text=h,t.removeChild(i),t.removeChild(l),s>=18&&(login_obj.chapter4=!0,saveData())})}},e.prototype.touchHandler=function(e){if(this._remove)return void e.remove();if(!this._prnt.hero||!this._prnt.hero._move){{var t=e.type;e.stageX,e.stageY}"mousedown"==t||"pressmove"==t||"pressup"==t&&(this._remove=!0,this.pushPuzzle(this.puzzle))}},e.prototype.removeAllListener=function(){this._remove=!0,this.removeEventListener("mousedown",this.touchHandler),this.removeEventListener("pressmove",this.touchHandler),this.removeEventListener("pressup",this.touchHandler)},window.ItemPuzzle=e}();