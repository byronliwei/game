!function(){var e=function(){this.initialize(),this.init()};e.prototype=new createjs.Container,e.prototype.init=function(){this.face_mc=new createjs.Container,this.game_mc=new createjs.Container,this.cells_mc=new createjs.Container,this._gameOver,this.arButtons=[],this.arItems=[],this.arBgInvent=[],this.levelObj={},this.curObj,this.bFire=!1,login_obj.location=7,this.bgDay=new ItemAnima("location1_6_daynight"),this.bgDay.scaleX=1.5*scaleGraphics,this.bgDay.scaleY=1.2*scaleGraphics,this.bgDay.x=630*scaleGraphics,this.bgDay.y=250*scaleGraphics,this.bgDay.sprite.gotoAndStop(login_obj["1_night"]?0:1),this.addChild(this.bgDay);var e=preload.getResult("location1_7");this.bgGame=new createjs.Bitmap(e),this.bgGame.scaleX=scaleGraphics,this.bgGame.scaleY=scaleGraphics,this.addChild(this.bgGame),this.addChild(this.game_mc),this.addChild(this.face_mc),this.face_mc.addChild(this.cells_mc),this.loadLevel(),this.touchHandler=this.touchHandler.bind(this),this.addEventListener("mousedown",this.touchHandler),this.addEventListener("pressmove",this.touchHandler),this.addEventListener("pressup",this.touchHandler)},e.prototype.loadLevel=function(){this.torch1Fire=new ItemAnima("animFire"),this.torch1Fire.scaleX=scaleGraphics,this.torch1Fire.scaleY=scaleGraphics,this.torch1Fire.x=120*scaleGraphics,this.torch1Fire.y=185*scaleGraphics,this.torch1Fire.sprite.gotoAndPlay("one"),this.game_mc.addChild(this.torch1Fire),this.Arrow1=this.addObj("Strelka8",100,500),this.Arrow1.name="Arrow1",this.Arrow1._selected=!1,this.game_mc.addChild(this.Arrow1),this.Arrow2=this.addObj("Strelka3",930,500),this.Arrow2.name="Arrow2",this.Arrow2._selected=!1,this.game_mc.addChild(this.Arrow2),login_obj.l1_7_lozaFire||(this.loza=this.addObj("l1_7_loza",625,645),this.game_mc.addChild(this.loza),this.arItems.push(this.loza),this.Arrow2.visible=!1,this.torch1Fire.name="torch1Fire",this.torch1Fire.w=2*this.torch1Fire.width,this.torch1Fire.h=2*this.torch1Fire.height,this.arItems.push(this.torch1Fire),this.fires=new createjs.Container,this.fires.alpha=0,this.game_mc.addChild(this.fires),this.createFires()),login_obj.l1_7_gearTook||(this.gear1=this.addObj("l1_7_gear",45,620),this.game_mc.addChild(this.gear1),this.arItems.push(this.gear1)),this.arItems.push(this.Arrow1),this.arButtons.push(this.Arrow1),this.arItems.push(this.Arrow2),this.arButtons.push(this.Arrow2),this.hero=new ItemHero,this.hero._parent=this,this.hero.scaleY=scaleGraphics,this.game_mc.addChild(this.hero),8==login_obj.prevLoc?(this.hero.scaleX=-1*scaleGraphics,this.hero.x=800*scaleGraphics,this.hero.y=480*scaleGraphics):(this.hero.scaleX=1*scaleGraphics,this.hero.x=200*scaleGraphics,this.hero.y=480*scaleGraphics),this.textHero=new ItemText,this.textHero._parent=this,this.textHero.scaleX=scaleGraphics,this.textHero.scaleY=scaleGraphics,this.textHero.y=this.hero.y-100*scaleGraphics,this.hero.x<300*scaleGraphics?(this.textHero.oblachko.scaleX=-1,this.textHero.x=this.hero.x+200*scaleGraphics):this.textHero.x=this.hero.x-200*scaleGraphics,this.game_mc.addChild(this.textHero),login_obj.l1_7_lozaFire||(this.hero.showText(),this.textHero.showText("emergence_1_7")),this.createCells(),this.loadInvent()},e.prototype.createFires=function(){var e=new ItemAnima("animFire");e.scaleX=scaleGraphics,e.scaleY=scaleGraphics,e.x=700*scaleGraphics,e.y=480*scaleGraphics,e.sprite.gotoAndPlay("one"),this.fires.addChild(e);var t=new ItemAnima("animFire");t.scaleX=scaleGraphics,t.scaleY=scaleGraphics,t.x=590*scaleGraphics,t.y=520*scaleGraphics,t.sprite.gotoAndPlay("one"),this.fires.addChild(t);var i=new ItemAnima("animFire");i.scaleX=scaleGraphics,i.scaleY=scaleGraphics,i.x=640*scaleGraphics,i.y=560*scaleGraphics,i.sprite.gotoAndPlay("one"),this.fires.addChild(i);var s=new ItemAnima("animFire");s.scaleX=scaleGraphics,s.scaleY=scaleGraphics,s.x=555*scaleGraphics,s.y=620*scaleGraphics,s.sprite.gotoAndPlay("one"),this.fires.addChild(s);var s=new ItemAnima("animFire");s.scaleX=scaleGraphics,s.scaleY=scaleGraphics,s.x=610*scaleGraphics,s.y=690*scaleGraphics,s.sprite.gotoAndPlay("one"),this.fires.addChild(s)},e.prototype.createCells=function(){var e,t=0;for(t=0;8>t;t++){var e=this.addObj("Cell",944-120*t,688);e.alpha=0,e.empty=!0,this.cells_mc.addChild(e),this.arBgInvent.push(e)}},e.prototype.addObj=function(e,t,i,s,r){s||(s=1),r||(r=1);var a=new createjs.Container,h=preload.getResult(e),o=new createjs.Bitmap(h);return o.x=-(o.image.width/2),o.y=-(o.image.height/2),a.addChild(o),a.scaleX=scaleGraphics*s,a.scaleY=scaleGraphics*r,a.x=t*scaleGraphics,a.y=i*scaleGraphics,a.w=o.image.width*a.scaleX,a.h=o.image.height*a.scaleY,a.name=e,a.w<50&&(a.w=50),a.h<50&&(a.h=50),a},e.prototype.pushObj=function(e){if(e){var t,i=0;for(i=0;i<this.arBgInvent.length&&(t=this.arBgInvent[i],!t.empty);i++);var s=this;t&&(createjs.Tween.get(t).to({alpha:1},200),createjs.Tween.get(e).to({x:t.x,y:t.y},300).call(function(){"l1_7_gear"==e.name&&(login_obj.l1_7_gearTook=!0,reportFound(e.name,"Gear-8")),invent_obj.push(e),s.removeFromArray(s.arItems,e.name),s.face_mc.addChild(e),s.refreshInvent()}))}},e.prototype.clickObj=function(e){var t=e.name,i=this;if(this.curObj)if("torch1Fire"==t){if("i_l1_5_torch"==this.curObj.name){var s=new ItemAnima("animFire");s.x=25,s.y=-35,s.sprite.gotoAndPlay("one"),this.curObj.addChild(s),this.removeFromArray(this.arItems,t),this.bFire=!0}}else"l1_7_loza"==t&&"i_l1_5_torch"==this.curObj.name&&this.bFire&&(reportUsed("l1_5_torch","Torch"),createjs.Tween.get(this.fires).to({alpha:1},1e3).wait(1500).to({alpha:0},300).call(function(){i.Arrow2.visible=!0}),createjs.Tween.get(e).wait(1500).to({alpha:0},300),this.removeFromArray(this.arItems,t),this.removeFromArray(invent_obj,"i_l1_5_torch"),this.face_mc.removeChild(this.curObj),this.refreshInvent(),login_obj.l1_7_lozaFire=!0,saveData());else if("l1_7_gear"==t)this.pushObj(e);else{if("Arrow1"==t)return this._gameOver=!0,e.visible=!1,void this.hero.initMove(e,function(){i.removeAllListener(),showGame(4),saveData()});if("Arrow2"==t)return this._gameOver=!0,e.visible=!1,void this.hero.initMove(e,function(){i.removeAllListener(),showGame(8),saveData()})}this.curObj&&this.refreshInvent()},e.prototype.loadInvent=function(){invent_obj=[];for(var e=0;e<login_obj.arInvent.length;e++){var t=login_obj.arInvent[e];if(t){var i=this.addObj(t,0,0);invent_obj.push(i)}}this.refreshInvent()},e.prototype.refreshInvent=function(){var e,t,i=0;for(i=0;i<this.arBgInvent.length;i++){if(t=this.arBgInvent[i],t.empty=!0,invent_obj&&(e=invent_obj[i])){t.empty=!1;var s=e.name,r=s.indexOf("i_");-1==r&&(this.face_mc.removeChild(e),e=this.addObj("i_"+s,0,0),invent_obj[i]=e),e.x=t.x,e.y=t.y,this.face_mc.addChild(e)}t.empty&&1==t.alpha&&createjs.Tween.get(t).to({alpha:0},200),0==t.empty&&0==t.alpha&&createjs.Tween.get(t).to({alpha:1},200)}},e.prototype.removeFromArray=function(e,t,i){var s,r=0;for(r=0;r<e.length;r++)if(s=e[r],s.name==t){i&&this.face_mc.removeChild(s),e.splice(r,1);break}},e.prototype.turnHandler=function(e){return this._gameOver?void e.remove():void 0},e.prototype.checkInvent=function(e){for(var t=e.stageX,i=e.stageY,s=null,r=0;r<invent_obj.length;r++){var a=invent_obj[r];if(hit_test_rec(a,a.w,a.h,t,i)){s=a;break}}return s},e.prototype.checkButtons=function(e){for(var t=e.stageX,i=e.stageY,s=0;s<this.arButtons.length;s++){var r=this.arButtons[s];hit_test_rec(r,r.w,r.h,t,i)?r.visible&&0==r._selected&&(r._selected=!0,r.scaleX=1.2*scaleGraphics,r.scaleY=1.2*scaleGraphics):r._selected&&(r.scaleX=scaleGraphics,r.scaleY=scaleGraphics,r._selected=!1)}},e.prototype.touchHandler=function(e){if(this._gameOver)return void e.remove();var t,i,s=e.type,r=e.stageX,a=e.stageY,h=0;if("mousedown"==s)this.curObj=this.checkInvent(e),null==this.curObj&&this.checkButtons(e);else if("pressmove"==s)this.checkButtons(e),this.curObj?(this.curObj.x=r,this.curObj.y=a):this.checkButtons(e);else if("pressup"==s){for(i=getDD(this.hero.x,this.hero.y,r,a),this.Hand&&1!=login_obj.tutor_1&&(login_obj.tutor_1=!0,createjs.Tween.get(this.Hand).to({x:480*scaleGraphics,y:320*scaleGraphics},1e3)),i<hitHero*scaleGraphics?this.hero.say?(this.hero.hideText(),this.textHero.hideText()):(this.hero.showText(),this.textHero.showText()):(this.hero.hideText(),this.textHero.hideText(),this.stars&&this.stars.removeAll()),h=0;h<this.arItems.length;h++)if(t=this.arItems[h],hit_test_rec(t,t.w,t.h,r,a)&&t.visible)return void this.clickObj(t);this.curObj&&this.refreshInvent()}},e.prototype.removeAllListener=function(){this.hero&&this.hero.removeAllListener(),this._resultGame=!0,this.removeEventListener("mousedown",this.touchHandler),this.removeEventListener("pressmove",this.touchHandler),this.removeEventListener("pressup",this.touchHandler)},window.ScrLocation7=e}();